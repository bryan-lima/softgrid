!function(){"use strict";function softGrid($filter,$base64,$timeout,$compile){return{restrict:"E",replace:!0,scope:{data:"=",cols:"=",width:"=",actions:"=",hide:"=",subgrid:"=",template:"=",sgControls:"=",sgMenu:"=",sgStore:"="},templateUrl:"softgrid.html",link:function(scope,element){var enableLog=!1;scope.loading=!1,scope.container=$(element[0]).find(".softgrid-container")[0],scope.configuration=$(element[0]).find(".softgrid-configuration")[0],scope.sg_currentPage=1,scope.sg_linesPerPageInput=10,scope.sg_linesPerPage=10,scope.sg_orderBy="",scope.sg_filterSearch="",scope.larguraColunaControles=0,scope.sg_selected=!1,scope.sg_checked=!1,scope.filteredData=[],scope.sg_filter="",scope.sg_cols=[];var firstLoad=!0;function _getFilteredData(){var n;enableLog&&console.log("getFilteredData"),scope.filteredData=scope.data,""===scope.sg_filter||null===scope.sg_filter||angular.isUndefined(scope.sg_filter)||((n=scope.cols.filter(function(e){return e.checked})).length<=0&&(n=scope.sg_cols),scope.filteredData=scope.filteredData.filter(function(e){for(var t=!1,o=0;o<n.length;o++)if("text"===n[o].type||"html"===n[o].type||"date"===n[o].type||!angular.isDefined(n[o].type))if(n[o].item&&"string"!=typeof n[o].item)if(null!=(s=n[o].item(e))){var s=removeAccents(s="string"!=typeof s?s.toString():s),a=removeAccents(scope.sg_filter);if(-1<s.indexOf(a)){t=!0;break}}return t}),scope.sgControls&&angular.isDefined(scope.sgControls.filtered)&&(scope.sgControls.filtered=scope.filteredData)),scope.sg_sort({item:scope.sg_orderBy},scope.sg_orderByColIndex,!0)}function removeAccents(e){if(!e)return e;e=e.toUpperCase();var t,o,s={a:/[\xE0-\xE6]/g,e:/[\xE8-\xEB]/g,i:/[\xEC-\xEF]/g,o:/[\xF2-\xF6]/g,u:/[\xF9-\xFC]/g,c:/\xE7/g,n:/\xF1/g},a=[["Á","A"],["À","A"],["Â","A"],["Ã","A"],["É","E"],["È","E"],["Ê","E"],["Í","I"],["Ì","I"],["Î","I"],["Ó","O"],["Ò","O"],["Ô","O"],["Õ","O"],["Ú","U"],["Ù","U"],["Û","U"]];for(t in s)e=e.replace(s[t],t);for(o=0;o<a.length;o++)e=e.replace(a[o][0],a[o][1]);return e.toUpperCase()}function createTable(){var s="<table border='1' cellpadding='5'>",e=0;s+="<tr bgcolor='orange'>";for(var t,o=null,e=0;e<scope.cols.length;e++)"subgrid"!=scope.cols[e].type?angular.isFunction(scope.cols[e].item)&&(s+="<td><b>"+scope.cols[e].title+"</b></td>"):o=scope.cols[e].title;for(null!=o&&(s+="<td align='center'><b>"+o+"</b>"),s+="</tr>",e=0;e<scope.data.length;e++){var a,n,r,c=null;for(s+="<tr valign='top'>",t=0;t<scope.cols.length;t++)"subgrid"!=scope.cols[t].type?(a="",a=(a=scope.data[e]?angular.isFunction(scope.cols[t].item)?scope.cols[t].item(scope.data[e]):scope.data[e][scope.cols[t].propriedade]:a)||" - ",angular.isString(a)&&(a=removerCaracteresInvalidos(a)),angular.isFunction(scope.cols[t].item)&&(s+="<td>",s+=a,s+="</td>")):c=scope.cols[t];null!=c&&(n=c.cols,0<(r=c.item(scope.data[e])).length&&(s+="<td bgcolor='#F6F6F6'>",s+="<table border='1'>",s+="<tr>",angular.forEach(n,function(e){s+="<td><b>",s+=e.title,s+="</b></td>"}),s+="</tr>",angular.forEach(r,function(o){s+="<tr>",angular.forEach(n,function(e){var t="",t=(t=o?angular.isFunction(e.item)?e.item(o):o[e.propriedade]:t)||" - ";angular.isString(t)&&(t=removerCaracteresInvalidos(t)),s+="<td>",s+=t,s+="</td>"}),s+="</tr>"}),s+="</table>",s+="</td>")),s+="</tr>"}return s+="</table>"}function _atualizarPaginacao(){if(scope.data){enableLog&&console.log("atualizarPaginacao"),scope.totalPages=scope.filteredData.length/scope.sg_linesPerPage,scope.totalPages=scope.totalPages>parseInt(scope.totalPages)?parseInt(scope.totalPages)+1:scope.totalPages,scope.sg_currentPage=scope.totalPages<scope.sg_currentPage?scope.totalPages:scope.sg_currentPage,scope.soft_pages=[],scope.soft_pages.push({text:"<span class='fa fa-chevron-left'></span>",value:-1,active:!1}),1<scope.totalPages&&scope.soft_pages.push({text:"1..",value:1,active:1===scope.sg_currentPage});for(var e=scope.sg_currentPage,t=2;t<scope.totalPages;t++)(t<e+3||e<=3&&t<=6)&&(3<=e&&e-3<t||e<=3&&t<=5||3<=e&&e<=t&&t<=e-3||e>=scope.totalPages-3&&t>=scope.totalPages-5||e<=3&&t<=6)&&scope.soft_pages.push({text:t,value:t,active:t==e});scope.soft_pages.push({text:".."+scope.totalPages,value:scope.totalPages,active:scope.sg_currentPage===scope.totalPages}),scope.soft_pages.push({text:"<span class='fa fa-chevron-right'></span>",value:0,active:!1})}}function maskEmail(e){return"<a href='mailto:"+e+"'><span class='fa fa-envelope-o'></span> "+e+"</a>"}function maskPhone(e){return e=(e=(e=e.replace(/\D/g,"")).replace(/^(\d{2})(\d)/g,"($1) $2")).replace(/(\d)(\d{4})$/,"$1-$2")}function removerCaracteresInvalidos(e){return e.replace("\\","").replace('"',"").replace("“","").replace("”","").replace("‘","").replace("’","").replace("º","").replace("–","")}function _configurarRedimensionarColuna(){$(".softgrid th").mousedown(function(e){scope.elementoRedimensionado=$(this),scope.redimensionandoColuna=!0,scope.posicaoElementoX=e.pageX,scope.larguraElementoX=$(this).width()}),$(document).mousemove(function(e){scope.redimensionandoColuna&&$(scope.elementoRedimensionado).width(scope.larguraElementoX+(e.pageX-scope.posicaoElementoX))}),$(document).mouseup(function(){scope.redimensionandoColuna&&(scope.redimensionandoColuna=!1,scope.$apply())})}function _obterColuna(e){return scope.sg_cols[e]}function _obterLinha(e){return scope.showData[e]}function _hookDropDown(){$(".softgrid-container .dropdown").on("click",function(){var e=$(this),t=e.offset().top,o=$(this).height(),s=e.find(".dropdown-menu"),a=$(this).find(".btn").offset().left,e=$(window).scrollTop();s.css("top",t+o-e),s.css("left",a)}),$(window).scroll(function(){var e,t,o=$(".softgrid .dropdown.open");0<o.length&&(e=o.find(".dropdown-menu"),t=$(this).scrollTop(),e.css("top",o.offset().top+o.height()-t))})}scope.sg_changePage=function(e){enableLog&&console.log("sg_changePage"),-1===e&&1<scope.sg_currentPage?scope.sg_currentPage=scope.sg_currentPage-1:-1===e&&1===scope.sg_currentPage?scope.sg_currentPage=scope.totalPages:0===e&&scope.sg_currentPage===scope.totalPages?scope.sg_currentPage=1:0===e&&scope.sg_currentPage<scope.totalPages?scope.sg_currentPage=scope.sg_currentPage+1:scope.sg_currentPage=e,_atualizarPaginacao(),_getFilteredData()},scope.sg_changeLinesPerPage=function(e){(-1===e&&10<scope.sg_linesPerPageInput||1===e)&&(scope.sg_linesPerPageInput=scope.sg_linesPerPageInput+10*e),enableLog&&console.log("sg_changeLinesPerPage")},scope.sg_sort=function(e,t,o){if(enableLog&&console.log("sg_sort"),!angular.isUndefined(scope.filteredData)){if(0<scope.filteredData.length){if(null!==scope.sg_orderBy&&scope.sg_orderByColIndex===t&&scope.reverse&&!o)return scope.sg_orderBy=null,scope.reverse=!1,scope.sg_orderByColIndex=-1,firstLoad||_saveStorage(),void _renderizarTabela();o||(null!==scope.sg_orderBy&&scope.sg_orderByColIndex!==t&&(scope.reverse=!1),null!==scope.sg_orderBy&&scope.sg_orderByColIndex===t&&(scope.reverse=!0)),scope.sg_orderByColIndex=t,scope.filteredData=$filter("orderBy")(scope.filteredData,e.item,scope.reverse),scope.sg_orderBy=e.item,firstLoad||_saveStorage()}_atualizarPaginacao(),_renderizarTabela()}},scope.sg_mask=function(e,t){return"phone"===e?maskPhone(t):"mail"===e?maskEmail(t):"date"===e?$filter("date")(t,"dd/MM/yyyy"):t},scope.sg_selectAll=function(){scope.filteredData&&0<scope.filteredData.length&&(scope.sg_selected=!scope.sg_selected,angular.forEach(scope.filteredData,function(e){scope.sgControls.select.item&&(e[scope.sgControls.select.item]=scope.sg_selected)}),scope.sgControls.select.callback(scope.filteredData))},scope.sg_checkAll=function(t){scope.filteredData&&0<scope.filteredData.length&&(scope.sg_checked=!scope.sg_checked,angular.forEach(scope.filteredData,function(e){scope.sg_cols[t].item&&(e[scope.sg_cols[t].item]=scope.sg_checked)}),scope.sg_cols[t].callback(scope.filteredData),_renderizarTabela())},scope.sg_checkCol=function(e,t){e.checked=!e.checked,t.stopPropagation(),_getFilteredData()},scope.sg_hook=function(){_atualizarPaginacao(),_hookDropDown()},scope.exportExcel=function(){for(var e=createTable(),t=new Array(e.length),o=0;o<e.length;o++)t[o]=e.charCodeAt(o);var s=new Uint8Array(t),a=new Blob([s],{type:"data:application/vnd.ms-excel"}),s=document.createElement("a");s.setAttribute("href",URL.createObjectURL(a)),s.setAttribute("download",(new Date).toLocaleString()+".xls"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},scope.exportarPDF=function(){scope.loading=!0;var r=$(element[0]).find(".softgrid-container")[0],c=$(r).width(),l=scope.sg_cols,i=scope.sg_linesPerPage,t=[595.28,921.89];scope.sg_cols=l.filter(function(e){return angular.isFunction(e.item)&&"subgrid"!=e.type}),scope.sg_linesPerPage=scope.data.length,_renderizarTabela(),$timeout(function(){$(r).width(t[1]).css("max-width","none"),$(r).css("max-height","none"),$(r).height(r.clientHeight),$(r).css("position","fixed"),$(r).css("top","0"),$(r).css("left","0"),$(".softgrid th").css("padding","1px"),$timeout(function(){var e=$(element[0]).find(".softgrid-container")[0];domtoimage.toPng(e,{quality:.75,bgcolor:"#FFFFFF",height:r.clientHeight,width:t[1]}).then(function(e){var n=new Image;n.onload=function(){for(var e=new jsPDF({unit:"px",format:"a4",orientation:"landscape"}),t=0;t<=r.clientHeight/589;t++){var o=n,s=589*t;window.onePageCanvas=document.createElement("canvas"),onePageCanvas.setAttribute("width",978),onePageCanvas.setAttribute("height",589),onePageCanvas.getContext("2d").drawImage(o,0,s,978,589,0,0,908,589);var a=onePageCanvas.toDataURL("image/png",1),o=onePageCanvas.width,s=onePageCanvas.clientHeight;0<t&&e.addPage(),e.setPage(t+1),e.addImage(a,"PNG",10,10,.72*o,.71*s)}e.save((new Date).toLocaleString()+".pdf"),$(r).width(c),$(r).height("auto"),$(r).css("position","relative"),$(".softgrid th").css("padding","5px"),scope.sg_cols=l,scope.sg_linesPerPage=i,_renderizarTabela(),scope.loading=!1,scope.$apply()},n.src=e})},1e3)},1e3)},scope.redimensionandoColuna=!1,scope.elementoRedimensionado=void 0,scope.posicaoElementoX=0,scope.larguraElementoX=0,scope.sg_edit=function(e){var t;null!==scope.sg_editandoColunaValor&&""!==scope.sg_editandoColunaValor&&(t=_obterColuna(scope.sg_editandoColunaIndex),scope.showData[scope.sg_editandoLinhaIndex][t.edit.item]=scope.sg_editandoColunaValor,t.edit.function(_obterLinha(scope.sg_editandoLinhaIndex))),scope.sg_editandoColuna=!1,scope.sg_editandoColunaValor=null,scope.sg_editandoLinhaIndex=0,scope.sg_editandoColunaIndex=0,_renderizarTabela()},scope.sg_editandoColuna=!1,scope.sg_editandoColunaValor=null,scope.sg_editandoLinhaIndex=0,scope.sg_editandoColunaIndex=0,scope.sg_openEdit=function(e,t,o){var s;scope.sg_editandoColuna||(scope.sg_editandoColuna=!0,scope.sg_editandoColunaIndex=e,scope.sg_editandoLinhaIndex=t,scope.sg_editandoValor=scope.sg_cols[e].item(scope.showData[t]),o=o.currentTarget,e="<input id='sg_edit_input' class='edit-input' ng-model='sg_editandoColunaValor' ng-blur='sg_edit(this)' tooltip data-toggle='tooltip' data-placement='top' title='Digite o novo valor. Valor atual: "+scope.sg_editandoValor+"'style='color: black !important; width: "+scope.sg_cols[e].edit.width+";'>",angular.element(o).append($compile(e)(scope)),$(o).find("label").css("display","none"),s=$("#sg_edit_input"),$timeout(function(){""!==s.value?s.select():s.focus()},200))},$timeout(_configurarRedimensionarColuna,500),scope.$watch("showData",function(e,t){$timeout(_renderizarTabela,200)},!0),scope.$watch("data",function(){enableLog&&console.log("dataWatcher"),_getFilteredData(),scope.sg_orderBySaved&&(scope.sg_orderByColIndex=-1,angular.isDefined(scope.sg_orderBySaved)&&scope.sg_sort(scope.sg_orderBySaved,scope.sg_orderByColIndexSaved,!0)),scope.data&&0<scope.data.length&&(firstLoad?(scope.sgStore&&_loadStorage(),firstLoad=!1):scope.sg_currentPage=1),_atualizarPaginacao()}),scope.$watch("sg_linesPerPageInput",function(){enableLog&&console.log("linesPerPageInputWatcher"),0<scope.sg_linesPerPageInput&&(scope.sg_linesPerPage=parseInt(scope.sg_linesPerPageInput),firstLoad||_saveStorage(),_getFilteredData())}),scope.$watch("sgControls",function(){enableLog&&console.log("sgControlsWatcher"),angular.isDefined(scope.sgControls)&&scope.sgControls&&(scope.sgControls.checkAll=scope.sg_checkAll,scope.sgControls.create&&(scope.larguraColunaControles+=60),scope.sgControls.read&&(scope.larguraColunaControles+=60),scope.sgControls.update&&(scope.larguraColunaControles+=60),scope.sgControls.delete&&(scope.larguraColunaControles+=60))}),scope.$watch("hide",function(){enableLog&&console.log("hideWatcher"),scope.hide&&(!0!==scope.hide.pagination&&!0!==scope.hide.all||(scope.sg_linesPerPage=999))}),scope.$watch("subgrid",_calcularTamanhoColunaAcoes),scope.$watch("actions",_calcularTamanhoColunaAcoes),scope.$watch("sg_currentPage",function(){enableLog&&console.log("currentPageWatcher"),firstLoad||_saveStorage()}),scope.$watch("sg_filter",function(){enableLog&&console.log("filterWatcher"),scope.sg_changePage(1)}),scope.$watch("filteredData",function(){scope.linhaSelecionadaIndex=null});var flagCol=!0;function _controlesParaColunas(){var e,t=[];angular.isDefined(scope.cols)&&0<scope.cols.length&&(scope.sgControls&&scope.sgControls.checkBox&&t.push({type:"checkbox",title:"Selecionar",callback:scope.sgControls.checkBox.function,item:scope.sgControls.checkBox.item}),scope.subgrid&&t.push({type:"subgrid",title:"Detalhes",item:scope.subgrid.item,cols:scope.subgrid.cols,menu:scope.subgrid.actions,hide:scope.subgrid.hide,subgrid:scope.subgrid.subgrid}),scope.actions&&0<scope.actions.length&&(e={type:"menu",title:"Opções",menu:scope.actions},angular.isDefined(scope.sgControls)&&angular.isDefined(scope.sgControls.showAction)&&(e.showRow=scope.sgControls.showAction),t.push(e)),scope.sgControls&&(scope.sgControls.create&&t.push({type:"action",title:scope.sgControls.create.title||"Criar",callback:scope.sgControls.create.action,icon:scope.sgControls.create.icon||"fa-plus"}),scope.sgControls.read&&t.push({type:"action",title:scope.sgControls.read.title||"Ver",callback:scope.sgControls.read.action,icon:scope.sgControls.read.icon||"fa-search"}),scope.sgControls.update&&t.push({type:"action",title:scope.sgControls.update.title||"Criar",callback:scope.sgControls.update.action,icon:scope.sgControls.update.icon||"fa-pencil"}),scope.sgControls.delete&&t.push({type:"action",title:scope.sgControls.delete.title||"Criar",callback:scope.sgControls.delete.action,icon:scope.sgControls.delete.icon||"fa-trash"})),t=t.concat(scope.cols),scope.sgControls&&scope.sgControls.active&&t.push({type:"switch",title:scope.sgControls.activeTitle||"Ativo",item:scope.sgControls.activeCol,callback:scope.sgControls.activeFunction}),scope.sgControls&&scope.sgControls.favorite&&t.push({type:"favorite",title:"Favorito",item:scope.sgControls.favorite.item,callback:scope.sgControls.favorite.function,showRow:scope.sgControls.favorite.show}),scope.sgControls&&scope.sgControls.progress&&t.push({type:"progress",title:"Progresso",class:scope.sgControls.progress.class,item:scope.sgControls.progress.item}),scope.sgControls&&scope.sgControls.approve&&scope.sgControls.approve.showCol&&t.push({type:"approve",title:"Aprovação",showCol:scope.sgControls.approve.showCol,showRow:scope.sgControls.approve.show,callback:scope.sgControls.approve.callback}),flagCol&&(scope.cols=t,scope.sg_cols=scope.cols.filter(function(e){return angular.isUndefined(e.default)||!0===e.default}),flagCol=!1),_getFilteredData())}function _calcularTamanhoColunaAcoes(){scope.larguraColunaAcoes=0,scope.subgrid&&(scope.larguraColunaAcoes+=60),scope.actions&&0<scope.actions.length&&(scope.larguraColunaAcoes+=60)}function _saveStorage(){var e,t,o;scope.sgStore&&scope.sgStore.enabled&&((e={}).linesPerPage=scope.sg_linesPerPage,e.currentPage=scope.sg_currentPage,null!==scope.sg_orderBy?(e.orderBy={item:scope.sg_orderBy.toString(),reverse:scope.reverse,index:scope.sg_orderByColIndex},scope.sg_orderByColIndexSaved=e.orderBy.index,scope.sg_orderBySaved={item:scope.sg_orderBy}):(scope.sg_orderBySaved=null,scope.sg_orderByColIndexSaved=null),t=[],o=0,angular.forEach(scope.sg_cols,function(e){t.push({col:removeAccents(e.title).replace(" ",""),index:o}),o++}),e.cols=t,localStorage.setItem("SG-STORE_"+scope.sgStore.id,angular.toJson(e)),enableLog&&console.log("_saveStorage"))}function _loadStorage(){var _properties,_item,_colunas,_limpar;scope.sgStore&&scope.sgStore.enabled&&(_properties=angular.fromJson(localStorage.getItem("SG-STORE_"+scope.sgStore.id)),_properties&&(scope.sg_linesPerPage=scope.sg_linesPerPageInput=_properties.linesPerPage,scope.sg_currentPage=_properties.currentPage,_properties.orderBy&&""!==_properties.orderBy.item&&(_item={item:eval("("+_properties.orderBy.item+")")},scope.sg_orderByColIndexSaved=_properties.orderBy.index,scope.sg_orderBySaved=_item,scope.reverse=_properties.orderBy.reverse,scope.sg_sort(_item,_properties.orderBy.index,!0)),_properties.cols&&(_controlesParaColunas(),_colunas=[],_limpar=!1,angular.forEach(_properties.cols,function(t){var e=scope.cols.filter(function(e){return removeAccents(e.title).replace(" ","")===t.col})[0];e?_colunas.push(e):_limpar=!0}),scope.sg_cols=_colunas,_limpar&&scope.limparConfiguracaoColuna(),_getFilteredData()),enableLog&&console.log("_loadStorage"),_atualizarPaginacao()))}function _alterarColunas(t,o){var s=[],a={};angular.forEach(scope.cols,function(e){removeAccents(e.title).replace(" ","")===o&&(a=e)}),angular.forEach(scope.sg_cols,function(e){removeAccents(e.title).replace(" ","")===t&&s.push(a),removeAccents(e.title).replace(" ","")!==o&&s.push(e)}),scope.sg_cols=s,_saveStorage(),_getFilteredData()}function _renderizarTabela(){enableLog&&console.log("_renderizarTabela"),$(scope.container).html(""),$(scope.configuration).html("");var r=!1,c=[];c.push("<div style='"+(scope.width?"width:"+scope.width+"px":"width: 100%")+"'>"),c.push("<table width='100%' "+(scope.subgrid?"id='softgrid'":"")+" class='softgrid "+scope.template+"'>"),c.push("<thead>");var t=0;angular.forEach(scope.sg_cols,function(e){c.push("<th id='sg_col_"+removeAccents(e.title).replace(" ","")+"' class='softgrid-th-drop'>"),c.push("<span class='fa fa-arrow-left'></span>"),c.push("<span class='title' ng-click='sg_sort(sg_cols["+t+"], "+t+")'>"),c.push(e.title),t===scope.sg_orderByColIndex&&c.push("<span class='fa "+(scope.reverse?"fa-sort-amount-desc":"fa-sort-amount-asc")+"'></span>"),c.push("</span>"),"checkbox"===e.type&&c.push("<input style='margin: 0px 0px 0px 5px;' type='checkbox' "+(scope.sg_checked?"checked":"")+" ng-click='sg_checkAll("+t+")'>"),scope.configuracaoAberta&&c.push("<span class='fa fa-times pull-right' ng-click='removerColuna(sg_cols["+t+"])'></span>"),c.push("</th>"),t++}),c.push("</thead>"),c.push("<tbody>"),scope.showData=$filter("limitTo")(scope.filteredData,scope.sg_linesPerPage,scope.sg_currentPage*scope.sg_linesPerPage-scope.sg_linesPerPage);var l=0;angular.forEach(scope.showData,function(a){var e="";scope.sgControls&&(scope.sgControls.changeRowColor&&"string"==typeof scope.sgControls.rowColor?!0===scope.sgControls.changeRowColor(a)&&(e="style='background-color: "+scope.sgControls.rowColor+"'"):angular.isDefined(scope.sgControls.rowColor)&&(e="style='background-color: "+scope.sgControls.rowColor(a)+"'")),c.push("<tr id='sg_linha_"+l+"' ng-click='sg_selecionarLinha("+l+")' class='soft-row "+(l%2?"soft-row-striped":"")+(scope.linhaSelecionadaIndex,"")+"' "+e+">");var n=0;angular.forEach(scope.sg_cols,function(t){var e="text"!==t.type&&"html"!==t.type&&angular.isDefined(t.type)?"text-align: center;":"";t.width="text"!==t.type&&"html"!==t.type&&angular.isDefined(t.type)&&angular.isUndefined(t.width)?"110px;":t.width;var o=t.style?t.style(a):"";if(c.push("<td style='"+o+e+(t.width?"width: "+t.width:"")+"'>"),angular.isUndefined(t.type)||"text"===t.type||"html"===t.type||"date"===t.type){e=t.edit?"title='Clique aqui para editar' ng-click='sg_openEdit("+n+", "+l+", $event)'":"";c.push("<div "+e+" style='"+(t.align?"text-align: "+t.align+";":"text-align: left;")+"'>"),t.popOver?c.push("<label style='text-decoration: underline; cursor: pointer' popover data-toggle='popover' data-trigger='hover' data-content='"+t.item(a)+"'>"+$filter("limitTo")(t.item(a),t.maxLength||999)+"</label>"):(c.push("<label style='width: 100%; "+o+"'>"),angular.isFunction(t.click)&&c.push("<a style='color: #f39c12; cursor: pointer; font-weight: bold' ng-click='sg_cols["+n+"].click(showData["+l+"])'>"),c.push(scope.sg_mask(t.type,t.item(a))),angular.isFunction(t.click)&&c.push("</a>"),c.push("</label>"))}else if("checkbox"===t.type)c.push("<input type='checkbox' ng-click='sg_cols["+n+"].callback(showData["+l+"])' "+(a[scope.sg_cols[n].item]?"checked":"")+">");else if("subgrid"===t.type)c.push("<button type='button' class='btn btn-default btn-sm btn-subgrid' ng-click='abrirSubGrid("+n+","+l+")'>"),c.push("<span class='fa "+(scope.showSubGrid?"fa-compress":"fa-expand")+"'></span></button>"),r=!0;else if("menu"===t.type){if(angular.isDefined(t.showRow)&&!t.showRow(a))return void n++;c.push("<div class='dropdown'>"),c.push("<button type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"),c.push("<span class='fa fa-bars'></span></button>"),c.push("<ul class='dropdown-menu dropdown-menu-left'>");var s=0;angular.forEach(t.menu,function(e){(!angular.isDefined(e.show)||e.show(a))&&(c.push("<li>"),c.push("<a ng-click='sg_cols["+n+"].menu["+s+"].function(showData["+l+"])'><span class='"+e.icon+"'></span>  "+e.title+"</a>"),c.push("</li>")),s++}),c.push("</ul></div>")}else if("action"===t.type)c.push("<button class='btn btn-default btn-sm' ng-click='sg_cols["+n+"].callback(showData["+l+"])' title='"+t.title+"'>"),c.push("<span class='fa "+t.icon+"'></span></button>");else if("switch"===t.type)c.push("<label class='switch'>"),c.push("<input type='checkbox' ng-click='sg_cols["+n+"].callback(showData["+l+"])' "+(scope.sg_cols[n].item(a)?"checked":"")+">"),c.push("<div class='slider round'></div>"),c.push("</label>");else if("favorite"===t.type){if(angular.isDefined(t.show)&&!t.show(a))return void n++;c.push("<span class='fa fa-star "+(t.item(a)?"active":"")+"' ng-click='sg_favoritar("+n+", "+l+")'></span>")}else if("progress"===t.type)c.push("<div class='progress'>"),c.push("<div class='progress-bar "+(t.class?t.class(a):"")+"' role='progressbar' style='width: "+t.item(a)+"%;'>"),c.push(t.item(a)+"%</div></div>");else if("approve"===t.type){if(!t.showCol(a)||!t.showRow(a))return void n++;c.push("<button title='Aprovar' class='btn btn-default btn-sm' ng-click='sg_cols["+n+"].callback(showData["+l+"], true)'><span class='fa fa-thumbs-up'></span></button>"),c.push("<button title='Reprovar' class='btn btn-default btn-sm' ng-click='sg_cols["+n+"].callback(showData["+l+"], false)'><span class='fa fa-thumbs-down'></span></button>")}else"select"===t.type&&(c.push("<div class='dropdown softgrid-dropdown-container'>"),c.push("<button type='button' class='btn btn-default btn-sm dropdown-toggle softgrid-dropdown' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"),c.push("<span class='fa fa-caret-down'></span>"+scope.showData[l][scope.sg_cols[n].item][scope.sg_cols[n].field.text]+"</button>"),c.push("<ul class='dropdown-menu dropdown-menu-left'>"),s=0,angular.forEach(t.data,function(e){c.push("<li>"),c.push("<a ng-click='sg_select("+n+", "+l+", "+s+")'> "+e[t.field.text]+"</a>"),c.push("</li>"),s++}),c.push("</ul></div>"));c.push("</div></td>"),n++}),c.push("</tr>"),r&&(c.push("<tr style='display: none' class='"+(l%2?"soft-row-striped":"")+"'>"),c.push("<td id='sg_subgrid_"+l+"' colspan='"+scope.sg_cols.length+"'>"),c.push("</td>"),c.push("</tr>")),l++}),angular.isDefined(scope.showData)&&scope.showData.length<=0&&c.push("<tr><td style='text-align: center;' colspan='"+scope.sg_cols.length+"'>Não há dados a serem exibidos.</td></tr>"),c.push("</tbody>"),c.push("</table>"),c.push("</div>"),angular.element(scope.container).append($compile(c.join(""))(scope));var o="<h5><label class='label label-primary'>Customizar Colunas</label></h5>",s=!0;angular.forEach(scope.cols,function(t){var e=scope.sg_cols.filter(function(e){return e.title===t.title});(!1===t.default&&e.length<=0||(angular.isUndefined(t.default)||!0===t.default)&&e.length<=0)&&(o+="<div id='sg_col_"+removeAccents(t.title).replace(" ","")+"' class='softgrid-configuration-col'>"+t.title+"</div>",s=!1)}),s&&(o+="<small>Todas as colunas estão sendo exibidas.</small>"),o+="<a href='javascript:void(0)' ng-click='limparConfiguracaoColuna()'>Limpar alterações</a>",angular.element(scope.configuration).append($compile(o)(scope)),scope.configuracaoAberta&&(_configurarDrop(),_configurarDrag()),_hookDropDown()}function _configurarDrag(){angular.forEach($(scope.configuration).find(".softgrid-configuration-col"),function(e,t){e=angular.element(e);"true"!==e.attr("draggable")&&(e.attr("draggable","true"),e.on("dragstart",_aoArrastarTarefa),e.on("dragend",_aoPararArrastarTarefa))})}function _aoArrastarTarefa(e){(e.dataTransfer?e:e.originalEvent).dataTransfer.setData("Text",e.target.id)}function _aoPararArrastarTarefa(e){}function _configurarDrop(){angular.forEach($(scope.container).find(".softgrid-th-drop"),function(e,t){e=angular.element(e);e.hasClass("softgrid-th-drop")&&"true"!==e.attr("draggable")&&(e.attr("draggable","true"),e.on("dragstart",_aoArrastarTarefa),e.on("dragover",function(e){e.preventDefault()}),e.on("dragenter",function(e){$(e.target).addClass("active")}),e.on("dragleave",function(e){$(e.target).removeClass("active")}),e.on("drop",_aoDroparTarefa))})}function _aoDroparTarefa(e){e.preventDefault();var t="",t=(e.dataTransfer?e:e.originalEvent).dataTransfer.getData("Text").replace("sg_col_","");_alterarColunas(e.target.id.replace("sg_col_",""),t)}scope.$watch("cols",function(){enableLog&&console.log("colsWatcher"),_controlesParaColunas()}),scope.abrirConfiguracao=function(){scope.configuracaoAberta=!scope.configuracaoAberta,scope.configuracaoAberta?($(scope.configuration).css("width","200px"),$(scope.configuration).css("border","1px solid #ccc"),$(scope.container).css("min-height","300px"),_getFilteredData()):($(scope.configuration).css("width","0"),$(scope.configuration).css("border","0"),$timeout(function(){$(scope.container).css("min-height","0")},500),_getFilteredData(),_configurarRedimensionarColuna())},scope.removerColuna=function(t){scope.sg_cols=scope.sg_cols.filter(function(e){return e.title!==t.title}),_saveStorage(),_getFilteredData()},scope.sg_selecionarLinha=function(e){angular.isDefined(scope.linhaSelecionadaIndex)&&$("#sg_linha_"+scope.linhaSelecionadaIndex).removeClass("active"),scope.linhaSelecionadaIndex=e,$("#sg_linha_"+e).addClass("active")},scope.sg_select=function(e,t,o){scope.sg_cols[e].callback(scope.showData[t],scope.sg_cols[e].data[o]),scope.showData[t][scope.sg_cols[e].item][scope.sg_cols[e].field.text]=scope.sg_cols[e].data[o][scope.sg_cols[e].field.text],scope.showData[t][scope.sg_cols[e].item][scope.sg_cols[e].field.value]=scope.sg_cols[e].data[o][scope.sg_cols[e].field.value]},scope.sg_favoritar=function(e,t){scope.sg_cols[e].callback(scope.showData[t]),$timeout(_renderizarTabela,1e3)},scope.limparConfiguracaoColuna=function(){scope.sg_cols=scope.cols.filter(function(e){return angular.isUndefined(e.default)||!0===e.default}),_saveStorage(),_renderizarTabela()},scope.abrirSubGrid=function(e,t){var o;$("#sg_subgrid_"+t).hasClass("active")?($("#sg_subgrid_"+t).html(""),$("#sg_subgrid_"+t).removeClass("active"),$($("#sg_subgrid_"+t).parent()).css("display","none")):((o=[]).push("<div class='soft-subgrid-container'>"),o.push("<softgrid cols='sg_cols["+e+"].cols' actions='sg_cols["+e+"].menu' data='sg_cols["+e+"].item(showData["+t+"])' hide='sg_cols["+e+"].hide' sg-controls='sg_cols["+e+"].controls' subgrid='sg_cols["+e+"].subgrid' template=\"'soft-subgrid'\"></softgrid>"),o.push("</div>"),angular.element($("#sg_subgrid_"+t)).append($compile(o.join(""))(scope)),$("#sg_subgrid_"+t).addClass("active"),$($("#sg_subgrid_"+t).parent()).css("display","table-row"))}}}}angular.module("softgrid.directive",["base64"]).directive("softgrid",softGrid),softGrid.$injector=["$filter","$base64","$timeout","$compíle"],angular.module("softgrid.directive").directive("popover",function(){return function(e,t){$(t).popover()}}),angular.module("softgrid.directive").directive("tooltip",function(){return function(e,t){$(t).tooltip()}})}(),angular.module("softgrid.directive").run(["$templateCache",function(e){e.put("softgrid.html",'\r\n<div class="softgrid-display" ng-class="{\'softgrid-display-fullscreen\': softgrid.fullscreen}">\r\n\r\n    <div class="grid-controles">\r\n\r\n        <div class="row" ng-hide="hide.all">\r\n\r\n            <div class="col-md-3">\r\n\r\n                <div ng-hide="hide.filter || hide.all">\r\n\r\n                    <label>Filtrar</label>\r\n                    <div class="input-group">\r\n                        <span class="input-group-addon" id="filtro-addon"><span class="fa fa-search"></span></span>\r\n                        <input type="text" class="form-control" ng-model="sg_filter" placeholder="Palavra-chave" aria-describedby="filtro-addon">\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-2">\r\n\r\n                <div class="form-group" ng-hide="hide.linesPage || hide.all">\r\n\r\n                    <label>Linhas por página</label>\r\n\r\n                    <div class="input-group" style="width: 120px;">\r\n\r\n                        <span class="input-group-btn">\r\n                            <button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(-1)">-</button>\r\n                        </span>\r\n\r\n                        <input class="form-control" value="{{sg_linesPerPage}}">\r\n\r\n                        <span class="input-group-btn">\r\n\t\t\t\t\t\t\t<button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(1)">+</button>\r\n\t\t\t\t\t\t</span>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-2">\r\n\r\n                <div ng-hide="hide.options || hide.all">\r\n\r\n                    <label>Opções</label>\r\n                    <div class="input-group">\r\n                        <input type="text" class="form-control" aria-label="..." value="{{data.length}} encontrado(s)" disabled="true">\r\n                        <div class="input-group-btn">\r\n                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-bars"></span></button>\r\n                            <ul class="dropdown-menu dropdown-menu-right">\r\n                                <li ng-repeat="item in menu">\r\n                                    <a ng-click="item.function()"><span class="{{item.icon}}"></span> {{item.title}}</a>\r\n                                </li>\r\n                                <li role="separator" class="divider" ng-show="menu"></li>\r\n                                \x3c!--<li><a ng-click="softGridToExcel()"><span class="fa fa-file-excel-o"></span> Gerar Excel</a></li>--\x3e\r\n                                <li><a ng-click="softgrid.fullscreen = softgrid.fullscreen ? false : true"><span class="fa fa-arrows-alt"></span> Tela Cheia</a></li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div ng-if="!subgrid">\r\n                    <a href="#" ng-show="false"  id="softDownload"></a>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-5">\r\n\r\n                <nav aria-label="Page navigation" class="pull-right" ng-hide="hide.pagination || hide.all">\r\n\r\n                    <label>Paginação</label>\r\n\r\n                        <ul class="pagination">\r\n\r\n                            <li ng-repeat="soft_page in soft_pages" ng-class="{\'active\': soft_page.active}">\r\n                                <a ng-click="sg_changePage(soft_page.value)" ng-bind-html="soft_page.text"></a>\r\n                            </li>\r\n\r\n                        </ul>\r\n\r\n                </nav>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="row">\r\n\r\n        <div class="col-md-12">\r\n\r\n                <div class="softgrid-container">\r\n\r\n                    <div ng-style=" width ? { \'width\': width + \'px\' } : { \'width\': \'100%\' }">\r\n\r\n                        <table ng-attr-id="{{!subgrid ? \'none\': \'softgrid\'}}" class="softgrid {{template}}" >\r\n\r\n                            <thead>\r\n\r\n                                <th ng-show="actions.length > 0 || subgrid" style="text-align:center; width: 120px;">\r\n\r\n                                </th>\r\n\r\n\t\t\t\t\t\t\t\t<th ng-show="controls.create || controls.read || controls.update || controls.delete" style="text-align: center;">\r\n\t\t\t\t\t\t\t\t\tAções\r\n\t\t\t\t\t\t\t\t</th>\r\n\r\n                                <th ng-repeat="col in cols" ng-show="!col.hide" style="text-align:center;">\r\n\r\n                                  <span class="title" ng-click="sg_sort(col.item)">\r\n\r\n\t\t\t\t\t\t\t\t\t  {{col.title}}\r\n\r\n\t\t\t\t\t\t\t\t\t  <span ng-show="col.item == sg_orderBy" class="fa fa-sort-amount-asc" ng-class="{\'fa-sort-amount-desc\' : reverse}"></span>\r\n\r\n\t\t\t\t\t\t\t\t  </span>\r\n\r\n                                </th>\r\n\r\n\t\t\t\t\t\t\t\t<th ng-show="controls.active" style="text-align: center;">\r\n\t\t\t\t\t\t\t\t\t{{controls.activeTitle}}\r\n\t\t\t\t\t\t\t\t</th>\r\n\r\n                            </thead>\r\n\r\n                            <tbody>\r\n\r\n                                <tr ng-init="$last ? sg_hook() : angular.noop()" ng-class="{\'soft-row-striped\': ($index%2)}" ng-repeat-start="row in (dataFiltered = (data | filter: sg_filter | limitTo: sg_linesPerPage : ((sg_currentPage * sg_linesPerPage) - sg_linesPerPage))) track by $index" ng-style="controls.changeRowColor(row) === true && {\'background-color\': (controls.rowColor ? controls.rowColor :\'#e59482\')}" >\r\n\r\n                                    <td  ng-show="subgrid || actions.length > 0" style="width: 200px; text-align:center;">\r\n\r\n                                        <div class="input-group" style="width: 120px;">\r\n\r\n                                            <div class="input-group-btn" >\r\n\r\n                                                \x3c!-- botão para exibir sub tabela --\x3e\r\n                                                <button ng-show="subgrid" type="button" class="btn btn-default btn-sm" ng-click="showSubGrid = showSubGrid ? false : true">\r\n                                                    <span class="fa fa-expand" ng-class="{\'fa-compress\': showSubGrid}"></span>\r\n                                                </button>\r\n\r\n                                            </div>\r\n\r\n                                            <div class="input-group-btn" >\r\n                                                <div class="dropdown">\r\n\r\n                                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n                                                        <span class="fa fa-bars"></span>\r\n                                                    </button>\r\n\r\n                                                    <ul class="dropdown-menu dropdown-menu-left">\r\n                                                        <li ng-repeat="action in actions"><a ng-click="action.function(row)"><span class="{{action.icon}}"></span> {{action.title}}</a></li>\r\n                                                    </ul>\r\n\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                        </div>\r\n\r\n                                    </td>\r\n\r\n\t\t\t\t\t\t\t\t\t\x3c!-- column to actions --\x3e\r\n\t\t\t\t\t\t\t\t\t<td ng-show="controls.create || controls.read || controls.update || controls.delete" style="text-align:center;">\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button ng-show="controls.create" type="button" class="btn btn-default btn-sm" ng-click="controls.create.action(row)" title="{{ controls.create.title ? controls.create.title : \'Criar\' }}">\r\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-plus"></span>   {{ controls.create.title }}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button ng-show="controls.read" type="button" class="btn btn-default btn-sm"   ng-click="controls.read.action(row)" title="{{ controls.read.title ? controls.read.title : \'Ver\' }}">\r\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-search"></span> {{ controls.read.title }}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button ng-show="controls.update" type="button" class="btn btn-default btn-sm" ng-click="controls.update.action(row)" title="{{ controls.update.title ? controls.update.title : \'Atualizar\' }}">\r\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-pencil"></span> {{ controls.update.title }}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button ng-show="controls.delete" type="button" class="btn btn-default btn-sm" ng-click="controls.delete.action(row)" title="{{ controls.delete.title ? controls.delete.title : \'Deletar\' }}">\r\n\t\t\t\t\t\t\t\t\t\t\t<span class="fa fa-trash"></span>  {{ controls.delete.title }}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\r\n                                    \x3c!-- data columns--\x3e\r\n                                    <td ng-repeat="col in cols">\r\n\r\n                                        <div ng-style="col.align ? { \'text-align\': col.align} : { \'text-align\': \'left\' }"> \x3c!--div para controlar o alinhamento--\x3e\r\n\r\n                                            <label ng-hide="col.popOver">\r\n\r\n                                                <div ng-if="col.item(row)">\r\n\r\n                                                    <span ng-bind-html="temp = sg_mask(col.type, (col.item(row) | limitTo: (col.maxLength ? col.maxLength : 999)))"></span>\r\n\r\n                                                </div>\r\n\r\n                                                <div ng-if="!col.item(row)">\r\n\r\n                                                    <font color="red">x</font>\r\n\r\n                                                </div>\r\n\r\n                                            </label>\r\n\r\n                                            <label style="text-decoration: underline; cursor: pointer" ng-show="col.popOver"   popover data-toggle="popover" data-trigger="hover" data-content="{{col.item(row)}}">{{(col.item(row) | limitTo: (col.maxLength ? col.maxLength : 999))}}</label>\r\n\r\n                                        </div>\r\n\r\n                                    </td>\r\n\r\n\t\t\t\t\t\t\t\t\t\x3c!-- Coluna para checkbox --\x3e\r\n\t\t\t\t\t\t\t\t\t<td style="text-align: center;" ng-show="controls.active">\r\n\t\t\t\t\t\t\t\t\t\t<label class="switch">\r\n\t\t\t\t\t\t\t\t\t\t\t<input type="checkbox" ng-checked="controls.activeCol(row)" ng-click="controls.activeFunction(row)">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class="slider round"></div>\r\n\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\r\n                                </tr>\r\n                                <tr ng-repeat-end="" ng-show="subgrid" ng-hide="!showSubGrid" ng-class="{\'soft-row-striped\': ($index%2)}"> \x3c!-- Linha para Subtabela --\x3e\r\n\r\n                                    <td colspan="{{cols.length + 3}}">\r\n\r\n                                        <div class="soft-subgrid-container">\r\n\r\n                                            <div ng-if="subgrid">\r\n\r\n                                                <softgrid  cols="subgrid.cols" actions="subgrid.actions" data="row[subgrid.object]" hide="subgrid.hide" template="\'soft-subgrid\'" controls="subgrid.controls"></softgrid>\r\n\r\n                                            </div>\r\n\r\n                                        </div>\r\n\r\n                                    </td>\r\n\r\n                                </tr>\r\n\r\n                                \x3c!-- Exibe uma linha caso não haja dados --\x3e\r\n                                <tr ng-show="!data || data.length <= 0" style="text-align: center;">\r\n\r\n                                    <td colspan="{{cols.length + 3}} ">\r\n                                    Não há dados a serem exibidos.\r\n                                    </td>\r\n                                </tr>\r\n\r\n                            </tbody>\r\n\r\n                        </table>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="row" ng-hide="hide.pagination || hide.all">\r\n\r\n        <div class="col-md-12">\r\n\r\n            <nav aria-label="...">\r\n                <ul class="pager" style="margin-top: 5px;">\r\n                    <li class="previous"><button class="btn btn-default pull-left" ng-click="soft_ChangePage(-1)"><span aria-hidden="true">&larr;</span> Página anterior</button></li>\r\n                    <li class="next"><button class="btn btn-default pull-right" ng-click="soft_ChangePage(0)">Próxima página <span aria-hidden="true">&rarr;</span></button></li>\r\n                </ul>\r\n            </nav>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>\r\n')}]);