!function(){"use strict";function softGrid($filter,$base64,$timeout,$compile){return{restrict:"E",replace:!0,scope:{data:"=",cols:"=",width:"=",actions:"=",hide:"=",subgrid:"=",template:"=",sgControls:"=",sgMenu:"=",sgStore:"="},templateUrl:"softgrid.html",link:function(scope,element){var enableLog=!1;scope.loading=!1,scope.container=$(element[0]).find(".softgrid-container")[0],scope.configuration=$(element[0]).find(".softgrid-configuration")[0],scope.sg_currentPage=1,scope.sg_linesPerPageInput=10,scope.sg_linesPerPage=10,scope.sg_orderBy="",scope.sg_filterSearch="",scope.larguraColunaControles=0,scope.sg_selected=!1,scope.sg_checked=!1,scope.filteredData=[],scope.sg_filter="",scope.sg_cols=[];var firstLoad=!0;function _getFilteredData(){var n;enableLog&&console.log("getFilteredData"),scope.filteredData=scope.data,""===scope.sg_filter||null===scope.sg_filter||angular.isUndefined(scope.sg_filter)||((n=scope.cols.filter(function(e){return e.checked})).length<=0&&(n=scope.sg_cols),scope.filteredData=scope.filteredData.filter(function(e){for(var o=!1,s=0;s<n.length;s++)if("text"===n[s].type||"html"===n[s].type||"date"===n[s].type||!angular.isDefined(n[s].type))if(n[s].item&&"string"!=typeof n[s].item)if(null!=(a=n[s].item(e))){var a=removeAccents(a="string"!=typeof a?a.toString():a),t=removeAccents(scope.sg_filter);if(-1<a.indexOf(t)){o=!0;break}}return o}),scope.sgControls&&angular.isDefined(scope.sgControls.filtered)&&(scope.sgControls.filtered=scope.filteredData)),scope.sg_sort({item:scope.sg_orderBy},scope.sg_orderByColIndex,!0)}function removeAccents(e){if(!e)return e;e=e.toUpperCase();var o,s,a={a:/[\xE0-\xE6]/g,e:/[\xE8-\xEB]/g,i:/[\xEC-\xEF]/g,o:/[\xF2-\xF6]/g,u:/[\xF9-\xFC]/g,c:/\xE7/g,n:/\xF1/g},t=[["Á","A"],["À","A"],["Â","A"],["Ã","A"],["É","E"],["È","E"],["Ê","E"],["Í","I"],["Ì","I"],["Î","I"],["Ó","O"],["Ò","O"],["Ô","O"],["Õ","O"],["Ú","U"],["Ù","U"],["Û","U"]];for(o in a)e=e.replace(a[o],o);for(s=0;s<t.length;s++)e=e.replace(t[s][0],t[s][1]);return e.toUpperCase()}function createTable(){var a="<table border='1' cellpadding='5'>",e=0;a+="<tr bgcolor='orange'>";for(var o,s=null,e=0;e<scope.cols.length;e++)"subgrid"!=scope.cols[e].type?angular.isFunction(scope.cols[e].item)&&(a+="<td><b>"+scope.cols[e].title+"</b></td>"):s=scope.cols[e].title;for(null!=s&&(a+="<td align='center'><b>"+s+"</b>"),a+="</tr>",e=0;e<scope.data.length;e++){var t,n,r,c=null;for(a+="<tr valign='top'>",o=0;o<scope.cols.length;o++)"subgrid"!=scope.cols[o].type?(t="",t=(t=scope.data[e]?angular.isFunction(scope.cols[o].item)?scope.cols[o].item(scope.data[e]):scope.data[e][scope.cols[o].propriedade]:t)||" - ",angular.isString(t)&&(t=removerCaracteresInvalidos(t)),angular.isFunction(scope.cols[o].item)&&(a+="<td>",a+=t,a+="</td>")):c=scope.cols[o];null!=c&&(n=c.cols,0<(r=c.item(scope.data[e])).length&&(a+="<td bgcolor='#F6F6F6'>",a+="<table border='1'>",a+="<tr>",angular.forEach(n,function(e){a+="<td><b>",a+=e.title,a+="</b></td>"}),a+="</tr>",angular.forEach(r,function(s){a+="<tr>",angular.forEach(n,function(e){var o="",o=(o=s?angular.isFunction(e.item)?e.item(s):s[e.propriedade]:o)||" - ";angular.isString(o)&&(o=removerCaracteresInvalidos(o)),a+="<td>",a+=o,a+="</td>"}),a+="</tr>"}),a+="</table>",a+="</td>")),a+="</tr>"}return a+="</table>"}function _atualizarPaginacao(){if(scope.data){enableLog&&console.log("atualizarPaginacao"),scope.totalPages=scope.filteredData.length/scope.sg_linesPerPage,scope.totalPages=scope.totalPages>parseInt(scope.totalPages)?parseInt(scope.totalPages)+1:scope.totalPages,scope.sg_currentPage=scope.totalPages<scope.sg_currentPage?scope.totalPages:scope.sg_currentPage,scope.soft_pages=[],scope.soft_pages.push({text:"<span class='fa fa-chevron-left'></span>",value:-1,active:!1}),1<scope.totalPages&&scope.soft_pages.push({text:"1..",value:1,active:1===scope.sg_currentPage});for(var e=scope.sg_currentPage,o=2;o<scope.totalPages;o++)(o<e+3||e<=3&&o<=6)&&(3<=e&&e-3<o||e<=3&&o<=5||3<=e&&e<=o&&o<=e-3||e>=scope.totalPages-3&&o>=scope.totalPages-5||e<=3&&o<=6)&&scope.soft_pages.push({text:o,value:o,active:o==e});scope.soft_pages.push({text:".."+scope.totalPages,value:scope.totalPages,active:scope.sg_currentPage===scope.totalPages}),scope.soft_pages.push({text:"<span class='fa fa-chevron-right'></span>",value:0,active:!1})}}function maskEmail(e){return"<a href='mailto:"+e+"'><span class='fa fa-envelope-o'></span> "+e+"</a>"}function maskPhone(e){return e=(e=(e=e.replace(/\D/g,"")).replace(/^(\d{2})(\d)/g,"($1) $2")).replace(/(\d)(\d{4})$/,"$1-$2")}function removerCaracteresInvalidos(e){return e.replace("\\","").replace('"',"").replace("“","").replace("”","").replace("‘","").replace("’","").replace("º","").replace("–","")}function _configurarRedimensionarColuna(){$(".softgrid th").mousedown(function(e){scope.elementoRedimensionado=$(this),scope.redimensionandoColuna=!0,scope.posicaoElementoX=e.pageX,scope.larguraElementoX=$(this).width()}),$(document).mousemove(function(e){scope.redimensionandoColuna&&$(scope.elementoRedimensionado).width(scope.larguraElementoX+(e.pageX-scope.posicaoElementoX))}),$(document).mouseup(function(){scope.redimensionandoColuna&&(scope.redimensionandoColuna=!1,scope.$apply())})}function _obterColuna(e){return scope.sg_cols[e]}function _obterLinha(e){return scope.showData[e]}function _hookDropDown(){$(".softgrid-container .dropdown").on("click",function(){var e=$(this),o=e.offset().top,s=$(this).height(),a=e.find(".dropdown-menu"),t=$(this).find(".btn").offset().left,e=$(window).scrollTop();a.css("top",o+s-e),a.css("left",t)}),$(window).scroll(function(){var e,o,s=$(".softgrid .dropdown.open");0<s.length&&(e=s.find(".dropdown-menu"),o=$(this).scrollTop(),e.css("top",s.offset().top+s.height()-o))})}scope.sg_changePage=function(e){enableLog&&console.log("sg_changePage"),-1===e&&1<scope.sg_currentPage?scope.sg_currentPage=scope.sg_currentPage-1:-1===e&&1===scope.sg_currentPage?scope.sg_currentPage=scope.totalPages:0===e&&scope.sg_currentPage===scope.totalPages?scope.sg_currentPage=1:0===e&&scope.sg_currentPage<scope.totalPages?scope.sg_currentPage=scope.sg_currentPage+1:scope.sg_currentPage=e,_atualizarPaginacao(),_getFilteredData()},scope.sg_changeLinesPerPage=function(e){(-1===e&&10<scope.sg_linesPerPageInput||1===e)&&(scope.sg_linesPerPageInput=scope.sg_linesPerPageInput+10*e),enableLog&&console.log("sg_changeLinesPerPage")},scope.sg_sort=function(e,o,s){if(enableLog&&console.log("sg_sort"),!angular.isUndefined(scope.filteredData)){if(0<scope.filteredData.length){if(null!==scope.sg_orderBy&&scope.sg_orderByColIndex===o&&scope.reverse&&!s)return scope.sg_orderBy=null,scope.reverse=!1,scope.sg_orderByColIndex=-1,firstLoad||_saveStorage(),void _renderizarTabela();s||(null!==scope.sg_orderBy&&scope.sg_orderByColIndex!==o&&(scope.reverse=!1),null!==scope.sg_orderBy&&scope.sg_orderByColIndex===o&&(scope.reverse=!0)),scope.sg_orderByColIndex=o,scope.filteredData=$filter("orderBy")(scope.filteredData,e.item,scope.reverse),scope.sg_orderBy=e.item,firstLoad||_saveStorage()}_atualizarPaginacao(),_renderizarTabela()}},scope.sg_mask=function(e,o){return"phone"===e?maskPhone(o):"mail"===e?maskEmail(o):"date"===e?$filter("date")(o,"dd/MM/yyyy"):o},scope.sg_selectAll=function(){scope.filteredData&&0<scope.filteredData.length&&(scope.sg_selected=!scope.sg_selected,angular.forEach(scope.filteredData,function(e){scope.sgControls.select.item&&(e[scope.sgControls.select.item]=scope.sg_selected)}),scope.sgControls.select.callback(scope.filteredData))},scope.sg_checkAll=function(o){scope.filteredData&&0<scope.filteredData.length&&(scope.sg_checked=!scope.sg_checked,angular.forEach(scope.filteredData,function(e){scope.sg_cols[o].item&&(e[scope.sg_cols[o].item]=scope.sg_checked)}),scope.sg_cols[o].callback(scope.filteredData),_renderizarTabela())},scope.sg_checkCol=function(e,o){e.checked=!e.checked,o.stopPropagation(),_getFilteredData()},scope.sg_hook=function(){_atualizarPaginacao(),_hookDropDown()},scope.exportExcel=function(){for(var e=createTable(),o=new Array(e.length),s=0;s<e.length;s++)o[s]=e.charCodeAt(s);var a=new Uint8Array(o),t=new Blob([a],{type:"data:application/vnd.ms-excel"}),a=document.createElement("a");a.setAttribute("href",URL.createObjectURL(t)),a.setAttribute("download",(new Date).toLocaleString()+".xls"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},scope.exportarPDF=function(){scope.loading=!0;var r=$(element[0]).find(".softgrid-container")[0],c=$(r).width(),l=scope.sg_cols,i=scope.sg_linesPerPage,o=[595.28,921.89];scope.sg_cols=l.filter(function(e){return angular.isFunction(e.item)&&"subgrid"!=e.type}),scope.sg_linesPerPage=scope.data.length,_renderizarTabela(),$timeout(function(){$(r).width(o[1]).css("max-width","none"),$(r).css("max-height","none"),$(r).height(r.clientHeight),$(r).css("position","fixed"),$(r).css("top","0"),$(r).css("left","0"),$(".softgrid th").css("padding","1px"),$timeout(function(){var e=$(element[0]).find(".softgrid-container")[0];domtoimage.toPng(e,{quality:.75,bgcolor:"#FFFFFF",height:r.clientHeight,width:o[1]}).then(function(e){var n=new Image;n.onload=function(){for(var e=new jsPDF({unit:"px",format:"a4",orientation:"landscape"}),o=0;o<=r.clientHeight/589;o++){var s=n,a=589*o;window.onePageCanvas=document.createElement("canvas"),onePageCanvas.setAttribute("width",978),onePageCanvas.setAttribute("height",589),onePageCanvas.getContext("2d").drawImage(s,0,a,978,589,0,0,908,589);var t=onePageCanvas.toDataURL("image/png",1),s=onePageCanvas.width,a=onePageCanvas.clientHeight;0<o&&e.addPage(),e.setPage(o+1),e.addImage(t,"PNG",10,10,.72*s,.71*a)}e.save((new Date).toLocaleString()+".pdf"),$(r).width(c),$(r).height("auto"),$(r).css("position","relative"),$(".softgrid th").css("padding","5px"),scope.sg_cols=l,scope.sg_linesPerPage=i,_renderizarTabela(),scope.loading=!1,scope.$apply()},n.src=e})},1e3)},1e3)},scope.redimensionandoColuna=!1,scope.elementoRedimensionado=void 0,scope.posicaoElementoX=0,scope.larguraElementoX=0,scope.sg_edit=function(e){var o;null!==scope.sg_editandoColunaValor&&""!==scope.sg_editandoColunaValor&&(o=_obterColuna(scope.sg_editandoColunaIndex),scope.showData[scope.sg_editandoLinhaIndex][o.edit.item]=scope.sg_editandoColunaValor,o.edit.function(_obterLinha(scope.sg_editandoLinhaIndex))),scope.sg_editandoColuna=!1,scope.sg_editandoColunaValor=null,scope.sg_editandoLinhaIndex=0,scope.sg_editandoColunaIndex=0,_renderizarTabela()},scope.sg_editandoColuna=!1,scope.sg_editandoColunaValor=null,scope.sg_editandoLinhaIndex=0,scope.sg_editandoColunaIndex=0,scope.sg_openEdit=function(e,o,s){var a;scope.sg_editandoColuna||(scope.sg_editandoColuna=!0,scope.sg_editandoColunaIndex=e,scope.sg_editandoLinhaIndex=o,scope.sg_editandoValor=scope.sg_cols[e].item(scope.showData[o]),s=s.currentTarget,e="<input id='sg_edit_input' class='edit-input' ng-model='sg_editandoColunaValor' ng-blur='sg_edit(this)' tooltip data-toggle='tooltip' data-placement='top' title='Digite o novo valor. Valor atual: "+scope.sg_editandoValor+"'style='color: black !important; width: "+scope.sg_cols[e].edit.width+";'>",angular.element(s).append($compile(e)(scope)),$(s).find("label").css("display","none"),a=$("#sg_edit_input"),$timeout(function(){""!==a.value?a.select():a.focus()},200))},$timeout(_configurarRedimensionarColuna,500),scope.$watch("showData",function(e,o){$timeout(_renderizarTabela,200)},!0),scope.$watch("data",function(){enableLog&&console.log("dataWatcher"),_getFilteredData(),scope.sg_orderBySaved&&(scope.sg_orderByColIndex=-1,angular.isDefined(scope.sg_orderBySaved)&&scope.sg_sort(scope.sg_orderBySaved,scope.sg_orderByColIndexSaved,!0)),scope.data&&0<scope.data.length&&(firstLoad?(scope.sgStore&&_loadStorage(),firstLoad=!1):scope.sg_currentPage=1),_atualizarPaginacao()}),scope.$watch("sg_linesPerPageInput",function(){enableLog&&console.log("linesPerPageInputWatcher"),0<scope.sg_linesPerPageInput&&(scope.sg_linesPerPage=parseInt(scope.sg_linesPerPageInput),firstLoad||_saveStorage(),_getFilteredData())}),scope.$watch("sgControls",function(){enableLog&&console.log("sgControlsWatcher"),angular.isDefined(scope.sgControls)&&scope.sgControls&&(scope.sgControls.checkAll=scope.sg_checkAll,scope.sgControls.create&&(scope.larguraColunaControles+=60),scope.sgControls.read&&(scope.larguraColunaControles+=60),scope.sgControls.update&&(scope.larguraColunaControles+=60),scope.sgControls.delete&&(scope.larguraColunaControles+=60))}),scope.$watch("hide",function(){enableLog&&console.log("hideWatcher"),scope.hide&&(!0!==scope.hide.pagination&&!0!==scope.hide.all||(scope.sg_linesPerPage=999))}),scope.$watch("subgrid",_calcularTamanhoColunaAcoes),scope.$watch("actions",_calcularTamanhoColunaAcoes),scope.$watch("sg_currentPage",function(){enableLog&&console.log("currentPageWatcher"),firstLoad||_saveStorage()}),scope.$watch("sg_filter",function(){enableLog&&console.log("filterWatcher"),scope.sg_changePage(1)}),scope.$watch("filteredData",function(){scope.linhaSelecionadaIndex=null});var flagCol=!0;function _controlesParaColunas(){var e,o=[];angular.isDefined(scope.cols)&&0<scope.cols.length&&(scope.sgControls&&scope.sgControls.checkBox&&o.push({type:"checkbox",title:"Selecionar",callback:scope.sgControls.checkBox.function,item:scope.sgControls.checkBox.item}),scope.subgrid&&o.push({type:"subgrid",title:"Detalhes",item:scope.subgrid.item,cols:scope.subgrid.cols,menu:scope.subgrid.actions,hide:scope.subgrid.hide,subgrid:scope.subgrid.subgrid}),scope.actions&&0<scope.actions.length&&(e={type:"menu",title:"Opções",menu:scope.actions},angular.isDefined(scope.sgControls)&&angular.isDefined(scope.sgControls.showAction)&&(e.showRow=scope.sgControls.showAction),o.push(e)),scope.sgControls&&(scope.sgControls.create&&o.push({type:"action",title:scope.sgControls.create.title||"Criar",callback:scope.sgControls.create.action,icon:scope.sgControls.create.icon||"fa-plus"}),scope.sgControls.read&&o.push({type:"action",title:scope.sgControls.read.title||"Ver",callback:scope.sgControls.read.action,icon:scope.sgControls.read.icon||"fa-search"}),scope.sgControls.update&&o.push({type:"action",title:scope.sgControls.update.title||"Criar",callback:scope.sgControls.update.action,icon:scope.sgControls.update.icon||"fa-pencil"}),scope.sgControls.delete&&o.push({type:"action",title:scope.sgControls.delete.title||"Criar",callback:scope.sgControls.delete.action,icon:scope.sgControls.delete.icon||"fa-trash"})),o=o.concat(scope.cols),scope.sgControls&&scope.sgControls.active&&o.push({type:"switch",title:scope.sgControls.activeTitle||"Ativo",item:scope.sgControls.activeCol,callback:scope.sgControls.activeFunction}),scope.sgControls&&scope.sgControls.favorite&&o.push({type:"favorite",title:"Favorito",item:scope.sgControls.favorite.item,callback:scope.sgControls.favorite.function,showRow:scope.sgControls.favorite.show}),scope.sgControls&&scope.sgControls.progress&&o.push({type:"progress",title:"Progresso",class:scope.sgControls.progress.class,item:scope.sgControls.progress.item}),scope.sgControls&&scope.sgControls.approve&&scope.sgControls.approve.showCol&&o.push({type:"approve",title:"Aprovação",showCol:scope.sgControls.approve.showCol,showRow:scope.sgControls.approve.show,callback:scope.sgControls.approve.callback}),flagCol&&(scope.cols=o,scope.sg_cols=scope.cols.filter(function(e){return angular.isUndefined(e.default)||!0===e.default}),flagCol=!1),_getFilteredData())}function _calcularTamanhoColunaAcoes(){scope.larguraColunaAcoes=0,scope.subgrid&&(scope.larguraColunaAcoes+=60),scope.actions&&0<scope.actions.length&&(scope.larguraColunaAcoes+=60)}function _saveStorage(){var e,o,s;scope.sgStore&&scope.sgStore.enabled&&((e={}).linesPerPage=scope.sg_linesPerPage,e.currentPage=scope.sg_currentPage,null!==scope.sg_orderBy?(e.orderBy={item:scope.sg_orderBy.toString(),reverse:scope.reverse,index:scope.sg_orderByColIndex},scope.sg_orderByColIndexSaved=e.orderBy.index,scope.sg_orderBySaved={item:scope.sg_orderBy}):(scope.sg_orderBySaved=null,scope.sg_orderByColIndexSaved=null),o=[],s=0,angular.forEach(scope.sg_cols,function(e){o.push({col:removeAccents(e.title).replace(" ",""),index:s}),s++}),e.cols=o,localStorage.setItem("SG-STORE_"+scope.sgStore.id,angular.toJson(e)),enableLog&&console.log("_saveStorage"))}function _loadStorage(){var _properties,_item,_colunas,_limpar;scope.sgStore&&scope.sgStore.enabled&&(_properties=angular.fromJson(localStorage.getItem("SG-STORE_"+scope.sgStore.id)),_properties&&(scope.sg_linesPerPage=scope.sg_linesPerPageInput=_properties.linesPerPage,scope.sg_currentPage=_properties.currentPage,_properties.orderBy&&""!==_properties.orderBy.item&&(_item={item:eval("("+_properties.orderBy.item+")")},scope.sg_orderByColIndexSaved=_properties.orderBy.index,scope.sg_orderBySaved=_item,scope.reverse=_properties.orderBy.reverse,scope.sg_sort(_item,_properties.orderBy.index,!0)),_properties.cols&&(_controlesParaColunas(),_colunas=[],_limpar=!1,angular.forEach(_properties.cols,function(o){var e=scope.cols.filter(function(e){return removeAccents(e.title).replace(" ","")===o.col})[0];e?_colunas.push(e):_limpar=!0}),scope.sg_cols=_colunas,_limpar&&scope.limparConfiguracaoColuna(),_getFilteredData()),enableLog&&console.log("_loadStorage"),_atualizarPaginacao()))}function _alterarColunas(o,s){var a=[],t={};angular.forEach(scope.cols,function(e){removeAccents(e.title).replace(" ","")===s&&(t=e)}),angular.forEach(scope.sg_cols,function(e){removeAccents(e.title).replace(" ","")===o&&a.push(t),removeAccents(e.title).replace(" ","")!==s&&a.push(e)}),scope.sg_cols=a,_saveStorage(),_getFilteredData()}function _renderizarTabela(){enableLog&&console.log("_renderizarTabela"),$(scope.container).html(""),$(scope.configuration).html("");var r=!1,c=[];c.push("<div style='"+(scope.width?"width:"+scope.width+"px":"width: 100%")+"'>"),c.push("<table width='100%' "+(scope.subgrid?"id='softgrid'":"")+" class='softgrid "+scope.template+"'>"),c.push("<thead>");var o=0;angular.forEach(scope.sg_cols,function(e){c.push("<th id='sg_col_"+removeAccents(e.title).replace(" ","")+"' class='softgrid-th-drop'>"),c.push("<span class='fa fa-arrow-left'></span>"),c.push("<span class='title' ng-click='sg_sort(sg_cols["+o+"], "+o+")'>"),c.push(e.title),o===scope.sg_orderByColIndex&&c.push("<span class='fa "+(scope.reverse?"fa-sort-amount-desc":"fa-sort-amount-asc")+"'></span>"),c.push("</span>"),"checkbox"===e.type&&c.push("<input style='margin: 0px 0px 0px 5px;' type='checkbox' "+(scope.sg_checked?"checked":"")+" ng-click='sg_checkAll("+o+")'>"),scope.configuracaoAberta&&c.push("<span class='fa fa-times pull-right' ng-click='removerColuna(sg_cols["+o+"])'></span>"),c.push("</th>"),o++}),c.push("</thead>"),c.push("<tbody>"),scope.showData=$filter("limitTo")(scope.filteredData,scope.sg_linesPerPage,scope.sg_currentPage*scope.sg_linesPerPage-scope.sg_linesPerPage);var l=0;angular.forEach(scope.showData,function(t){var e="";scope.sgControls&&(scope.sgControls.changeRowColor&&"string"==typeof scope.sgControls.rowColor?!0===scope.sgControls.changeRowColor(t)&&(e="style='background-color: "+scope.sgControls.rowColor+"'"):angular.isDefined(scope.sgControls.rowColor)&&(e="style='background-color: "+scope.sgControls.rowColor(t)+"'")),c.push("<tr id='sg_linha_"+l+"' ng-click='sg_selecionarLinha("+l+")' class='soft-row "+(l%2?"soft-row-striped":"")+(scope.linhaSelecionadaIndex,"")+"' "+e+">");var n=0;angular.forEach(scope.sg_cols,function(o){var e="text"!==o.type&&"html"!==o.type&&angular.isDefined(o.type)?"text-align: center;":"";o.width="text"!==o.type&&"html"!==o.type&&angular.isDefined(o.type)&&angular.isUndefined(o.width)?"110px;":o.width;var s=o.style?o.style(t):"";if(c.push("<td style='"+s+e+(o.width?"width: "+o.width:"")+"'>"),angular.isUndefined(o.type)||"text"===o.type||"html"===o.type||"date"===o.type){e=o.edit?"title='Clique aqui para editar' ng-click='sg_openEdit("+n+", "+l+", $event)'":"";c.push("<div "+e+" style='"+(o.align?"text-align: "+o.align+";":"text-align: left;")+"'>"),o.popOver?c.push("<label style='text-decoration: underline; cursor: pointer' popover data-toggle='popover' data-trigger='hover' data-content='"+o.item(t)+"'>"+$filter("limitTo")(o.item(t),o.maxLength||999)+"</label>"):(c.push("<label style='width: 100%; "+s+"'>"),angular.isFunction(o.click)&&c.push("<a style='color: #f39c12; cursor: pointer; font-weight: bold' ng-click='sg_cols["+n+"].click(showData["+l+"])'>"),c.push(scope.sg_mask(o.type,o.item(t))),angular.isFunction(o.click)&&c.push("</a>"),c.push("</label>"))}else if("checkbox"===o.type)c.push("<input type='checkbox' ng-click='sg_cols["+n+"].callback(showData["+l+"])' "+(t[scope.sg_cols[n].item]?"checked":"")+">");else if("subgrid"===o.type)c.push("<button type='button' class='btn btn-default btn-sm btn-subgrid' ng-click='abrirSubGrid("+n+","+l+")'>"),c.push("<span class='fa "+(scope.showSubGrid?"fa-compress":"fa-expand")+"'></span></button>"),r=!0;else if("menu"===o.type){if(angular.isDefined(o.showRow)&&!o.showRow(t))return void n++;c.push("<div class='dropdown'>"),c.push("<button type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"),c.push("<span class='fa fa-bars'></span></button>"),c.push("<ul class='dropdown-menu dropdown-menu-left'>");var a=0;angular.forEach(o.menu,function(e){(!angular.isDefined(e.show)||e.show(t))&&(c.push("<li>"),c.push("<a ng-click='sg_cols["+n+"].menu["+a+"].function(showData["+l+"])'><span class='"+e.icon+"'></span>  "+e.title+"</a>"),c.push("</li>")),a++}),c.push("</ul></div>")}else if("action"===o.type)c.push("<button class='btn btn-default btn-sm' ng-click='sg_cols["+n+"].callback(showData["+l+"])' title='"+o.title+"'>"),c.push("<span class='fa "+o.icon+"'></span></button>");else if("switch"===o.type)c.push("<label class='switch'>"),c.push("<input type='checkbox' ng-click='sg_cols["+n+"].callback(showData["+l+"])' "+(scope.sg_cols[n].item(t)?"checked":"")+">"),c.push("<div class='slider round'></div>"),c.push("</label>");else if("favorite"===o.type){if(angular.isDefined(o.show)&&!o.show(t))return void n++;c.push("<span class='fa fa-star "+(o.item(t)?"active":"")+"' ng-click='sg_favoritar("+n+", "+l+")'></span>")}else if("progress"===o.type)c.push("<div class='progress'>"),c.push("<div class='progress-bar "+(o.class?o.class(t):"")+"' role='progressbar' style='width: "+o.item(t)+"%;'>"),c.push(o.item(t)+"%</div></div>");else if("approve"===o.type){if(!o.showCol(t)||!o.showRow(t))return void n++;c.push("<button title='Aprovar' class='btn btn-default btn-sm' ng-click='sg_cols["+n+"].callback(showData["+l+"], true)'><span class='fa fa-thumbs-up'></span></button>"),c.push("<button title='Reprovar' class='btn btn-default btn-sm' ng-click='sg_cols["+n+"].callback(showData["+l+"], false)'><span class='fa fa-thumbs-down'></span></button>")}else"select"===o.type&&(c.push("<div class='dropdown softgrid-dropdown-container'>"),c.push("<button type='button' class='btn btn-default btn-sm dropdown-toggle softgrid-dropdown' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"),c.push("<span class='fa fa-caret-down'></span>"+scope.showData[l][scope.sg_cols[n].item][scope.sg_cols[n].field.text]+"</button>"),c.push("<ul class='dropdown-menu dropdown-menu-left'>"),a=0,angular.forEach(o.data,function(e){c.push("<li>"),c.push("<a ng-click='sg_select("+n+", "+l+", "+a+")'> "+e[o.field.text]+"</a>"),c.push("</li>"),a++}),c.push("</ul></div>"));c.push("</div></td>"),n++}),c.push("</tr>"),r&&(c.push("<tr style='display: none' class='"+(l%2?"soft-row-striped":"")+"'>"),c.push("<td id='sg_subgrid_"+l+"' colspan='"+scope.sg_cols.length+"'>"),c.push("</td>"),c.push("</tr>")),l++}),angular.isDefined(scope.showData)&&scope.showData.length<=0&&c.push("<tr><td style='text-align: center;' colspan='"+scope.sg_cols.length+"'>Não há dados a serem exibidos.</td></tr>"),c.push("</tbody>"),c.push("</table>"),c.push("</div>"),angular.element(scope.container).append($compile(c.join(""))(scope));var s="<h5><label class='label label-primary'>Customizar Colunas</label></h5>",a=!0;angular.forEach(scope.cols,function(o){var e=scope.sg_cols.filter(function(e){return e.title===o.title});(!1===o.default&&e.length<=0||(angular.isUndefined(o.default)||!0===o.default)&&e.length<=0)&&(s+="<div id='sg_col_"+removeAccents(o.title).replace(" ","")+"' class='softgrid-configuration-col'>"+o.title+"</div>",a=!1)}),a&&(s+="<small>Todas as colunas estão sendo exibidas.</small>"),s+="<a href='javascript:void(0)' ng-click='limparConfiguracaoColuna()'>Limpar alterações</a>",angular.element(scope.configuration).append($compile(s)(scope)),scope.configuracaoAberta&&(_configurarDrop(),_configurarDrag()),_hookDropDown()}function _configurarDrag(){angular.forEach($(scope.configuration).find(".softgrid-configuration-col"),function(e,o){e=angular.element(e);"true"!==e.attr("draggable")&&(e.attr("draggable","true"),e.on("dragstart",_aoArrastarTarefa),e.on("dragend",_aoPararArrastarTarefa))})}function _aoArrastarTarefa(e){(e.dataTransfer?e:e.originalEvent).dataTransfer.setData("Text",e.target.id)}function _aoPararArrastarTarefa(e){}function _configurarDrop(){angular.forEach($(scope.container).find(".softgrid-th-drop"),function(e,o){e=angular.element(e);e.hasClass("softgrid-th-drop")&&"true"!==e.attr("draggable")&&(e.attr("draggable","true"),e.on("dragstart",_aoArrastarTarefa),e.on("dragover",function(e){e.preventDefault()}),e.on("dragenter",function(e){$(e.target).addClass("active")}),e.on("dragleave",function(e){$(e.target).removeClass("active")}),e.on("drop",_aoDroparTarefa))})}function _aoDroparTarefa(e){e.preventDefault();var o="",o=(e.dataTransfer?e:e.originalEvent).dataTransfer.getData("Text").replace("sg_col_","");_alterarColunas(e.target.id.replace("sg_col_",""),o)}scope.$watch("cols",function(){enableLog&&console.log("colsWatcher"),_controlesParaColunas()}),scope.abrirConfiguracao=function(){scope.configuracaoAberta=!scope.configuracaoAberta,scope.configuracaoAberta?($(scope.configuration).css("width","200px"),$(scope.configuration).css("border","1px solid #ccc"),$(scope.container).css("min-height","300px"),_getFilteredData()):($(scope.configuration).css("width","0"),$(scope.configuration).css("border","0"),$timeout(function(){$(scope.container).css("min-height","0")},500),_getFilteredData(),_configurarRedimensionarColuna())},scope.removerColuna=function(o){scope.sg_cols=scope.sg_cols.filter(function(e){return e.title!==o.title}),_saveStorage(),_getFilteredData()},scope.sg_selecionarLinha=function(e){angular.isDefined(scope.linhaSelecionadaIndex)&&$("#sg_linha_"+scope.linhaSelecionadaIndex).removeClass("active"),scope.linhaSelecionadaIndex=e,$("#sg_linha_"+e).addClass("active")},scope.sg_select=function(e,o,s){scope.sg_cols[e].callback(scope.showData[o],scope.sg_cols[e].data[s]),scope.showData[o][scope.sg_cols[e].item][scope.sg_cols[e].field.text]=scope.sg_cols[e].data[s][scope.sg_cols[e].field.text],scope.showData[o][scope.sg_cols[e].item][scope.sg_cols[e].field.value]=scope.sg_cols[e].data[s][scope.sg_cols[e].field.value]},scope.sg_favoritar=function(e,o){scope.sg_cols[e].callback(scope.showData[o]),$timeout(_renderizarTabela,1e3)},scope.limparConfiguracaoColuna=function(){scope.sg_cols=scope.cols.filter(function(e){return angular.isUndefined(e.default)||!0===e.default}),_saveStorage(),_renderizarTabela()},scope.abrirSubGrid=function(e,o){var s;$("#sg_subgrid_"+o).hasClass("active")?($("#sg_subgrid_"+o).html(""),$("#sg_subgrid_"+o).removeClass("active"),$($("#sg_subgrid_"+o).parent()).css("display","none")):((s=[]).push("<div class='soft-subgrid-container'>"),s.push("<softgrid cols='sg_cols["+e+"].cols' actions='sg_cols["+e+"].menu' data='sg_cols["+e+"].item(showData["+o+"])' hide='sg_cols["+e+"].hide' sg-controls='sg_cols["+e+"].controls' subgrid='sg_cols["+e+"].subgrid' template=\"'soft-subgrid'\"></softgrid>"),s.push("</div>"),angular.element($("#sg_subgrid_"+o)).append($compile(s.join(""))(scope)),$("#sg_subgrid_"+o).addClass("active"),$($("#sg_subgrid_"+o).parent()).css("display","table-row"))}}}}angular.module("softgrid.directive",["base64"]).directive("softgrid",softGrid),softGrid.$injector=["$filter","$base64","$timeout","$compíle"],angular.module("softgrid.directive").directive("popover",function(){return function(e,o){$(o).popover()}}),angular.module("softgrid.directive").directive("tooltip",function(){return function(e,o){$(o).tooltip()}})}(),angular.module("softgrid.directive").run(["$templateCache",function(e){e.put("softgrid.html",'\r\n<div class="softgrid-display" ng-class="{\'softgrid-display-fullscreen\': softgrid.fullscreen}" ng-style="sgControls.fullscreen && softgrid.fullscreen ? { \'z-index\': sgControls.fullscreen.zindex, \'top\': sgControls.fullscreen.top + \'px\'} : \'\'">\r\n\r\n    <div class="grid-controles" ng-style="sgControls.fullscreen && softgrid.fullscreen ? { \'z-index\': (sgControls.fullscreen.zindex + 1), \'top\': (sgControls.fullscreen.top) + \'px\'} : \'\'">\r\n\r\n        <div class="row" ng-hide="hide.all">\r\n\r\n            <div class="col-md-2">\r\n\r\n                <div ng-hide="hide.filter || hide.all">\r\n\r\n                    <label>Filtrar</label>\r\n\r\n                    <div class="input-group">\r\n\r\n                        <div class="input-group-btn">\r\n\r\n                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-search"></span></button>\r\n\r\n                            <ul class="dropdown-menu dropdown-menu-left">\r\n\r\n                                <li ng-repeat="col in cols track by $index">\r\n\r\n                                    <a ng-click="sg_checkCol(col, $event)"> <input type="checkbox" ng-checked="col.checked" ng-click="sg_checkCol(col, $event)" /> {{col.title}} </a>\r\n\r\n                                </li>\r\n\r\n                            </ul>\r\n\r\n                        </div>\r\n\r\n                        <input type="text" class="form-control" ng-model="sg_filter" placeholder="Palavra-chave" aria-describedby="filtro-addon">\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-6">\r\n\r\n                <div class="row">\r\n\r\n                    <div class="col-md-4">\r\n\r\n                        <div class="form-group" ng-hide="hide.linesPage || hide.all || hide.pagination" style="margin-bottom: 0;">\r\n\r\n                            <label>Linhas por página</label>\r\n\r\n                            <div class="input-group" style="width: 120px;">\r\n\r\n                        <span class="input-group-btn">\r\n                            <button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(-1)">-</button>\r\n                        </span>\r\n\r\n                                <input class="form-control" ng-model="sg_linesPerPageInput">\r\n\r\n                                <span class="input-group-btn">\r\n\t\t\t\t\t\t\t<button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(1)">+</button>\r\n\t\t\t\t\t\t</span>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="col-md-4">\r\n\r\n                        <div ng-hide="hide.options || hide.all">\r\n\r\n                            <label>Opções</label>\r\n\r\n                            <div class="input-group">\r\n\r\n                                <input type="text" class="form-control" aria-label="..." value="{{filteredData.length}} encontrado(s)" disabled="true">\r\n\r\n                                <div class="input-group-btn">\r\n\r\n                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-bars"></span></button>\r\n\r\n                                    <ul class="dropdown-menu dropdown-menu-right">\r\n\r\n                                        <li ng-repeat="item in sgMenu">\r\n                                            <a ng-click="item.function()"><span class="{{item.icon}}"></span> {{item.title}}</a>\r\n                                        </li>\r\n\r\n                                        <li role="separator" class="divider" ng-show="sgMenu"></li>\r\n\r\n                                        <li ng-if="sgControls.select"><a ng-click="sg_selectAll()"><span class="fa fa-check"></span> Selecionar Todos</a></li>\r\n\r\n                                        <li><a ng-click="exportExcel()"><span class="fa fa-file-excel-o"></span> Exportar Excel</a></li>\r\n\r\n                                        <li><a ng-click="exportarPDF()"><span class="fa fa-file-pdf-o"></span> Exportar PDF</a></li>\r\n\r\n                                    </ul>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="col-md-4">\r\n\r\n                        <div ng-hide="hide.fullscreen || hide.all">\r\n\r\n                            <label>&nbsp;</label><br>\r\n                            <button class="btn btn-default" ng-click="softgrid.fullscreen = softgrid.fullscreen ? false : true"><span class="fa fa-expand" ng-class="{\'fa-compress\': softgrid.fullscreen}"></span>\r\n\r\n                                {{ softgrid.fullscreen ? (sgControls.fullscreen.on ? sgControls.fullscreen.on : \'Tela normal\') : (sgControls.fullscreen.off ? sgControls.fullscreen.off : \'Tela cheia\') }}\r\n\r\n                            </button>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-4">\r\n\r\n                <nav aria-label="Page navigation" class="pull-right" ng-hide="hide.pagination || hide.all">\r\n\r\n                    <label>Paginação</label>\r\n\r\n                        <ul class="pagination">\r\n\r\n                            <li ng-repeat="soft_page in soft_pages" ng-class="{\'active\': soft_page.active}">\r\n                                <a ng-click="sg_changePage(soft_page.value)" ng-bind-html="soft_page.text"></a>\r\n                            </li>\r\n\r\n                            <li ng-if="sgStore" title="Editar Colunas" ng-click="abrirConfiguracao()"><span class="fa fa-pencil"></span></li>\r\n                            \r\n                            \x3c!-- <div class="input-group-btn">\r\n                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-bars"></span></button>\r\n                                <ul class="dropdown-menu dropdown-menu-right">\r\n                                    <li ng-repeat="item in sgMenu">\r\n                                        <a ng-click="item.function()"><span class="{{item.icon}}"></span> {{item.title}}</a>\r\n                                    </li>\r\n                                    <li role="separator" class="divider" ng-show="sgMenu"></li>\r\n                                    <li ng-if="sgControls.select"><a ng-click="sg_selectAll()"><span class="fa fa-check"></span> Selecionar Todos</a></li>\r\n                                    <li><a ng-click="softGridToExcel()"><span class="fa fa-file-excel-o"></span> Gerar Excel</a></li>\r\n                                </ul>\r\n                            </div> --\x3e\r\n                        </ul>\r\n\r\n                </nav>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="row">\r\n\r\n        <div class="col-md-12">\r\n\r\n            <div class="softgrid-configuration scrolls">\r\n\r\n\r\n            </div>\r\n\r\n            <div class="softgrid-container">\r\n\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="row" ng-hide="hide.pagination || hide.all">\r\n\r\n        <div class="col-md-12">\r\n\r\n            <nav aria-label="...">\r\n                <ul class="pager" style="margin-top: 5px;">\r\n                    <li class="previous"><button class="btn btn-default pull-left" ng-click="sg_changePage(-1)"><span aria-hidden="true">&larr;</span> Página anterior</button></li>\r\n                    <li class="next"><button class="btn btn-default pull-right" ng-click="sg_changePage(0)">Próxima página <span aria-hidden="true">&rarr;</span></button></li>\r\n                </ul>\r\n            </nav>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="modal-loading" ng-if="loading">\r\n\r\n        <div class="lds-dual-ring"></div>\r\n\r\n    </div>\r\n\r\n</div>\r\n')}]);